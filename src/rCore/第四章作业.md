# 编程作业

## 重写sys_get_time和sys_task_info

引入虚存机制后，原来内核的 sys_get_time 和 sys_task_info 函数实现就无效了。请你重写这个函数，恢复其正常功能。

### 思路

原本的sys_get_time的实现如下：

```rust
/// get time with second and microsecond
pub fn sys_get_time(ts: *mut TimeVal, _tz: usize) -> isize {
    trace!("kernel: sys_get_time");
    increase_syscall_number(SYSCALL_GET_TIME);
    let us = get_time_us();
    unsafe {
        *ts = TimeVal {
            sec: us / 1_000_000,
            usec: us % 1_000_000,
        };
    }
    0
}
```
原本的sys_task_info实现如下：
```rust
pub fn sys_task_info(ti: *mut TaskInfo) -> isize {
    trace!("kernel: sys_task_info");
    increase_syscall_number(SYSCALL_TASK_INFO);
    if ti.is_null() {
        return -1;
    }
    let current_task = TASK_MANAGER.get_current_task();
    unsafe {
        (*ti).status = current_task.task_status;
        (*ti).syscall_times = current_task.syscall_times;
        (*ti).time = get_time_ms();
    };
    0
}
```

### 思路

先检查sys_get_time传入的指针是否有权限写入这个地址，因此要对ts的地址进行地址转换。之后过程相同。


